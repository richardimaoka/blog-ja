---
title: 2分間コーディングをさらに楽にする、gitとGitHub周りのテクニック
date: "2021-04-17T00:01:00.000+0900"
image: /images/20210417/repeat-commands.png
description: 以前紹介して好評だった2分間コーディング記事の続きで、今回はgitとGitHub周りの作業を省力化してさらにコーディングがはかどるテクニックを紹介します
---

以前2分間コーディングを紹介し、記事を読んだ多くの人に好意的にとらえていただきました。とても嬉しい限りです。

- [「2分間コーディングのすすめ、コードを書く習慣のハードルを下げる」 - リチャード 伊真岡 blog](https://blog-jp.richardimaoka.net/20210328)

さて今回は2分間コーディングを行う上でも役に立つ、gitとGitHubまわりの作業を省力化するテクニックを紹介します。

## GitHub草を生やすにはgitコマンドを頻繁に叩く必要がある

私と同じように緑色のGitHubのコントリビューショングラフ、通称「草」をモチベーションとする人は、頻繁にgitコマンドを実行するでしょうし、数多くのGitHubレポジトリも作成することでしょう。

<p align="center">
  <img src="images/20210417/github-grass.png" alt="github contribution graph">
</p>

コーディングの成果を毎回GitHubにpushするとなると、新しいコードを書くたびにgit init、git add、git commit、そしてGitHubにレポジトリを作ったらgit remote addしてからgit pushという一連の動作を繰り返さなくてはなりません。2分間コーディングを行っている場合、もしこれらの動作だけで1分間かかってしまったら、残り時間1分でコーディングすることになってしまいます。

<p align="center">
  <img src="images/20210417/repeat-commands.png" alt="github contribution graph">
</p>

毎日の習慣としてコーディング作業をストレスなく繰り返すには、これらのgitまわりの作業を省力化することが重要です。この記事で紹介するのは以下の4つのツールの組み合わせで、これによって一連の作業のタイピング数を減らし、楽にかつ高速に繰り返せるようになります。

- ghq
- peco
- ohMyZshのgitプラグイン
- GitHub CLI

## デモンストレーション

各ツールの使い方の詳細な説明に入る前に、百聞は一見にしかずということで、実際の動作を動画でお見せしましょう。素のgitコマンドよりも、タイプ数の少ないコマンドの組み合わせで作業が進んでいくのがわかると思います。

動画
ghq create go-hello-world
ctrl + ], reponame
pwd
ls -la
code .
insert main.go
ctrl + tab -> browser
search word = hello world go
mouse copy
ctrl + tab -> vscode
paste to main.go
ctrl + ` -> terminal
go run mian.go
gaa
gst
gc -m "go hello world"
ggp
ctrl + tab -> browser
search github
see my profile

動画をご覧いただいて、これらのツールの組み合わせの威力がおわかりいただけたでしょうか？それでは各ツールの使い方の詳細について説明していきます。

## 各ツールの使い方

### ghq + peco

[ghq](https://github.com/x-motemen/ghq)は、Go開発コミュニティの慣習がもたらす開発体験のよさに着想を得て開発された、今では日本の技術コミュニティを中心に、様々なプログラミング言語の使い手たちが利用しているコマンドライン・ツールです。はてなCTOである[motemen](https://twitter.com/motemen)さんが生み出し、現在はNature CTOである[songmu](https://twitter.com/songmu)さんがメンテナをつとめています。

ghqの持つコマンドの中から、最初に`ghq create`を紹介します。このコマンドはghqの推奨するディレクトリ構成に従ってディレクトリを作成し、かつgit initも自動で実行してくれます。

図解: 比較テーブル
実行結果何が起きたか？

ghqのすすめるディレクトリ構成に従うメリットについては、下記のリンク先を参考にしてください。

次にghqとpecoを組み合わせて、ディレクトリ移動を行う方法を説明します。事前に`Ctrl`と`]`キーの同時押しをショートカットして登録し、pecoで移動先のディレクトリを絞り込みます

アニメーション, ghq create -> Ctrl + ] -> hell-wor -> Enter


`Ctrl + ]`ショートカットを登録するのは以下のghq handbookの案内に従ってください

```
コードスニペット
```
handbookへのリンク

コマンド差分の画像

ここまででは、ghqとpecoのありがたみはさほど感じられないかもしれません。まだmkdirとcdとgit initが少し楽になっただけだからです。しかし、記事の後半で紹介する作業フロー例の中での利用例を踏まえ、毎日のようにghqやpecoを使った作業を繰り返す内に、これらのツールがもたらす、ほんの少しの違いの積み重ねが離れられないくらいの便利さを感じさせてくれるはずです。

### Oh My ZSH

次に紹介するのはzshの設定ベスト・プラクティスの詰め合わせ、Oh My ZSHです。

Oh My ZSHの前にまずはzshの話ですが、zshは2020年からMacBookのデフォルトのシェルになりました。今ではzshを普段の開発で使っている人も多いことでしょう。

> macOS Catalina から、Mac は zsh をデフォルトのログインシェルおよびインタラクティブシェルとして使うようになります。 - [zsh を Mac のデフォルトシェルとして使う](https://support.apple.com/ja-jp/HT208050)

zshに限らず、シェルを自分好みにカスタマイズするのは、相応の知識が必要で時間のかかる作業ですが、Oh My ZSHはそんな私達、独力でいくらでも好きなようにはシェルを改造できない開発者たちの強い味方です。ターミナルの色付けや自動補完、ショートカットキーの登録をはじめ、様々な設定を詰め合わせた、技術コミュニティのエキスパートたちの積み重ねを、インストールコマンドひとつで自分のシェル環境に適用できます。

毎日のようにGitHubにコードをpushする人にとって、特に便利なのOh My ZSHのgitプラグインです。これは下図のようにgitコマンドの省略形を提供してくれるので、繰り返せば繰り返すほど時間を節約してくれますし、軽快なリズムを失うこと無くGitHubのコントリビューション・グラフを育て続ける味方になってくれます。

コマンド差分の画像

## GitHub CLI

ツールの紹介の最後はGitHub CLIです。その名の通りGitHub公式ツールで、コマンドラインからGitHubの操作が可能です。2分間コーディングの結果をGitHubにpushする上で重要なのはgh repo createコマンドです。このコマンドによって、わざわざGitHubをWebブラウザで開いてレポジトリを作成しなくて良くなります。つまり、ターミナルから離れることなく作業を高速化出来ます。

コマンド差分の画像

github repo createコマンドは、そのままでは対話形式で何度も質問を投げかけてくるので、以下のように引数を与えると、対話形式の質問を1個だけに減らせます。この最後の質問、ローカルのレポジトリ名の指定は自動化しようとすると大変なので、Enterキー一回分押せば良いことを考えて、ここでは最後の質問は残しています。

## いくつかの作業フロー例

ここまではまっさらな新規のGitHubレポジトリを作成して、そこにコードをpushする例を前提にツールの使い方を紹介してきました。ここからは、その他のパターンの作業例を紹介します。いずれも2分間コーディングの一環として取り組めそうなものばかり集めたので、こういった一連の作業を省力化・高速化してみてください。

### 第3者GitHubレポジトリのフォーク、書き換え

GitHubで公開されているサンプルコードを手元に落として改変し、動作を確認するのは技術を覚える上で有効な手段です。手元で試して終わるだけでなく、GitHubのコントリビューション・グラフを育てるためには、フォークしてgit cloneしたうえで、改変が終わったらgit pushするのが良いでしょう。

コマンドの流れは以下のようになります。

Webブラウザからhttps://github.com/xxxxx/yyy に飛んで、レポジトリをfork


forkが終了したら、レポジトリのURLをコピー

ghq get -l  ぺーすとしたURL
code .
コード書き換え、走らす
gaa
gc -m “modified”
ggp

OSSやクラウドサービスのSDKの中には公式・非公式を問わず、GitHubレポジトリにサンプルコードを持つものが多くあります。例えば https://github.com/firebase/quickstart-js はサンプル集を収めたレポジトリですし、 https://github.com/grpc/grpc-go/tree/master/examples はOSSのソースコードの一部にexampleディレクトリが含まれています。

上記のように、最初からforkしたほうが少ないコマンドで済むのですが、最初は見るだけのつもりで大元のGitHubレポジトリをcloneしてしまい、後でpushするために自分のレポジトリが必要になった場合は以下のような流れになります。

Webブラウザからhttps://github.com/xxxxx/yyy に飛んで、レポジトリのURLをコピー
ghq get -l  ぺーすとしたURL
code .
コードを読む

途中で気が変わって、コード書き換えて自分のレポジトリにpushしたくなった
コード書き換えて走らす
gaa
gc -m “modified”
git remote add ...
ggp

### 既存レポジトリ再利用


ここではghqが真価を発揮します。自分が現在どのディレクトリにいたとしても`Ctrl + ]`ショートカットから素早く目的のレポジトリに飛んでコードの書き換えを開始できます

```go
Ctrl + ]
xxxxx
Enter
code .
gaa
gc -m “modified”
ggp
```

既存レポジトリ再利用の際に私が気に入っているテクニックは、go-sandbox, python-sandboxなどの-sandboxで終わる名前のレポジトリを作って何度も再利用することです。

例えばGoを何ヶ月か書けて学ぶ際に、書き捨てるレベルのコードをたくさん書いて勉強することになると思います。その際、本当に書き捨ててしまってはGitHubのコントリビューション・グラフが育ちませんし、一方で毎回新規レポジトリを作成してそこにコードをpushするのはレポジトリが増えすぎて収集がつかなくなります。そこで私は、go-sandboxというレポジトリを用意して、新しいコードを試すたびに以前のコードを消去しています。

```go
Ctrl + ]
xxxxx
Enter
code .
スクショを表示
main.goの中身を全消去
Ctrl + `でvscode ターミナル表示
gaa
gc -m “clean main.go”
vscode エディタで試したいコードをコピペする
go run main.go
gaa
gc -m “run new code”
ggp
```

これならば、少数の-sandboxレポジトリが存在するだけで、書き捨てレベルのコードはそこに入れてpushするだけで、GitHubコントリビューション・グラフを育ててモチベーションにすることが出来ます。

### まとめ: gitとGitHub周りを省力化するその前に

最後になってしまいましたが注意点をひとつ。2分間コーディングがまだ習慣化していない段階の人や、たまにしかgitやGitHub周りの作業を行わない人には、無理をして今すぐツールを入れる必要はありません。個人的には、gitやGitHub作業の繰り返しに大きなストレスを感じ始めてからの導入で良いと思います。

4つもの新しいツールを使い始めるのは、どうしても認知的な負荷が高くなります。今すぐ必要ないなら、あとから使い始めればよいだけです。私もgit使用歴5年以上経ちますが、2分間コーディングを始めた最近になってようやくこれらのツールが必要だと感じるようになりました。

もしあなたがgitやGitHub作業を習慣的に行っているなら、ここで紹介したテクニックが役立ってくれることを願います。

